<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health</title>
    <link rel="icon" type="x-icon" href="favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="bootstrap-5.3.0-alpha3-dist/css/bootstrap.css" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha384-DyZ88mC6Up2uqSse0N2Dq+2adKXXdR6suI6tvZp3zF5dfh2fjFDbiuYy5j0f1p4r" crossorigin="anonymous">
    <!-- section for animation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js" integrity="sha512-A7AYk1fGKX6S2SsHywmPkrnzTZHrgiVT7GcQkLGDe2ev0aWb8zejytzS8wjo7PGEXKqJOrjQ4oORtnimIRZBtw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
      AOS.init({
        duration: 2000,
      })
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

              /* for navbar logo */
        nav strong {
        color: gold;
        font-size: 40px;
        }

        /* for navbar item  */
        .nav-item a {
        color: #fff!important;
        font-size: 18px;
        }

        .nav-item a:hover{
          background-color: goldenrod;
        }

        /* For navbar sticky */
        .navbar {
            position: sticky;
            top: 0;
            background-color: black;
        }

        #jewelery, #trending {
            display: flex;
            flex-wrap: wrap;
            max-width: 100%;
            margin: 0 auto;
            justify-content: center;
            background-color: #fff;
            padding: 10px;
        }

        .product {
            width: 20rem;
            margin: 1em;
            border-radius: 5px;
            padding: 2px;
            background-color: #fff;
            cursor: pointer;
        }

        .product img {
            margin: 0 auto;
            justify-content: center;
            width: 240px;
            height: 200px;
            margin-bottom: 10px;
        }

        .details {
            display: none;
            border-radius: 5px;
            padding: 20px;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            max-width: 1250px;
            margin: 20px auto;
        }

        #back-button {
            display: block;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            border: none;
            padding: 10px;
            cursor: pointer;
        }

        .pagination {
            margin: 20px 0;
            text-align: center;
            justify-content: center;
        }

        .pagination button {
            margin: 0 5px;
            padding: 5px 10px;
            font-size: 1em;
        }

        .hidden {
            display: none;
        }


        /* share button section */
        #share-buttons-container {
            display: flex;
            overflow-x: auto;
            white-space: nowrap;
            padding: 10px;
        }
        /* share button section */
        #share-buttons-container button {
            border: none;
            background: none;
            cursor: pointer;
            font-size: 15px;
            margin: 15px;
        }
        /* share button section */
        #scroll-left, #scroll-right {
            cursor: pointer;
            font-size: 32px;
        }
    </style>
</head>

<body>
        <!-- ..........................for navbar..................... -->
        <nav class="navbar navbar-expand-lg bg-secondary">
            <div class="container-fluid">
    
                <a class="navbar-brand" href="index.html" style="color: white; font-size: 25px;"><strong>Mega</strong>News</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="index.html">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="About.html">About</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>


        <!-- Back button -->
<div id="trend" class="mt-3" >    
    <a style="font-size: larger; text-decoration: none;" href="index.html"><img src="Logos/Back-ARROW.png" class="rounded-circle" style="height: 35px; margin-left: 5px;"></a>
</div>

    <h2 style="margin-top: 10px;">Health</h2>
    <div id="jewelery" class="mt-2"></div>
    
     <!-- section for MegaNews Details -->
    <div id="product-details" class="details">
        <button id="back-button" class="btn btn-secondary">Back</button>
        <div id="details-content"></div>

        <div class="mt-5" id="scroll-left" onclick="scrollLeft()">&#9664; <p>Share to</p></div>
        <div id="share-buttons-container">
            <button onclick="shareToSocialMedia('facebook')"><img src="Logos/fb.png" class="rounded-circle"
                style="height: 35px"> <br> Facebook</button>
        <button onclick="shareToSocialMedia('twitter')"><img src="Logos/Twitter.png" class="rounded-circle"
                style="height: 35px"> <br> Twitter</button>
        <button onclick="shareToSocialMedia('whatsapp')"><img src="Logos/whatssap.png" class="rounded-circle"
                style="height: 35px"><br>Whatssap</button>
        <button onclick="shareToSocialMedia('email')"><img src="Logos/E-mail.png" class="rounded-circle"
                style="height: 35px"><br>E-mail</button>
        <button onclick="shareToSocialMedia('sms')"><img src="Logos/sms 1.png" class="rounded-circle"
                style="height: 35px"><br>SMS</button>
        <button onclick="shareToSocialMedia('instagram')"><img src="Logos/instagram.png" class="rounded-circle"
                style="height: 35px"><br>Instagram</button>
        <button onclick="shareToSocialMedia('tiktok')"><img src="Logos/TikTok.png" class="rounded-circle"
                style="height: 35px"><br>Tik-Tok</button>
        <button onclick="shareToSocialMedia('messenger')"><img src="Logos/fb_messenger.png" class="rounded-circle"
                style="height: 35px"><br>Facebook <br> Messenger</button>
        <button onclick="shareToSocialMedia('telegram')"><img src="Logos/Telegram.png" class="rounded-circle"
                style="height: 35px"><br>Telegram</button>
        <button onclick="shareToSocialMedia('copy')"> <img src="Logos/copy 1.png" class="rounded-circle"
                style="height: 35px"><br> Copy</button>
        <button onclick="shareToSocialMedia('native')"><img src="Logos/other.png" class="rounded-circle"
                style="height: 35px"><br>More</button>
        </div>
        <div id="scroll-right" onclick="scrollRight()">&#9654;</div>
    
 <!-- section for Trending News -->
        <h2 style="margin-top: 60px;">Trending News</h2>
        <div id="trending" class="mt-2"></div>  
        <br>
        <div style="text-align: center;"><a href="Trending.html" class="btn shadow" style="font-size: 20px;">Read more ...</a></div>
        <br><br><br>
        <!-- <button onclick="window.history.back(ba);" id="backs-button">Back</button>    -->
    </div>

      <!-- section for Next and  Previous button -->
    <div class="pagination">
        <button id="prevPage" onclick="prevPage()">Previous</button>
        <span id="pageInfo"></span>
        <button id="nextPage" onclick="nextPage()">Next</button>
    </div>

    <script>
        let currentPage = 1;
        const productsPerPage = 9;
        let allProducts = [];
        let allTrending = [];

        async function fetchData() {
            try {
                const response = await fetch('http://127.0.0.1:8000/api/');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                data.sort((a, b) => new Date(b.create_date) - new Date(a.create_date));
                allProducts = data.filter(product => product.category.name === "Health");
                displayProducts();
                allTrending = data.filter(product => product.category.name === "Trending News");
                displayTrendingProducts();
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

                // section for fetching first News........................................
        function displayProducts() {
            const jeweleryContainer = document.getElementById('jewelery');
            jeweleryContainer.innerHTML = '';

            const start = (currentPage - 1) * productsPerPage;
            const end = start + productsPerPage;
            const productsToShow = allProducts.slice(start, end);

            productsToShow.forEach(product => {
                const productElement = document.createElement('div');
                productElement.className = 'product';

                productElement.innerHTML = `
                <p style=" color: red; ">${new Date(product.create_date).toLocaleTimeString()}</p>
                <div style="display: flex;" class='shadow bg-body rounded'  data-aos='zoom-in'>
                    <div>
                        <img src="${product.picture}" alt="${product.title}" style="width: 60%; height: 90px;">
                        </div>
                        <div>
                            <p>${product.title}</p>
                    </div>
                </div>
                `;

                productElement.addEventListener('click', () => displayProductDetails(product));
                jeweleryContainer.appendChild(productElement);
            });

            updatePaginationInfo();
        }


      // ..........................Start of Trending News....................................
                      function displayTrendingProducts() {
                  const trendingContainer = document.getElementById('trending');
                  trendingContainer.innerHTML = '';

                  
                  const start = (currentPage - 1) * productsPerPage;
                  const end = start + productsPerPage;
                //   const productsToShow = allTrending.slice(start, end);
                  const productsToShow = allTrending.slice(0, 9);
                  
                  // Slice the first two trending products
                //    const productsToShow = allTrending.slice(0, 2);

            productsToShow.forEach(product => {
                const productElement = document.createElement('div');
                productElement.className = 'product';
                
                productElement.innerHTML = `
                <p style=" color: red; ">${new Date(product.create_date).toLocaleTimeString()}</p>
                <div style="display: flex;" class='shadow bg-body rounded'  data-aos='zoom-in'>
                    <div>
                        <img src="${product.picture}" alt="${product.title}" style="width: 60%; height: 90px;">
                        </div>
                        <div>
                            <h6>${product.title}</h6>
                    </div>
                </div>
                `;

                productElement.addEventListener('click', () => displayProductDetails(product));
                trendingContainer.appendChild(productElement);
            });

            updatePaginationInfo();
        }

        // Section for first News Details..........................................................
        function displayProductDetails(product) {
            const productDetailsContainer = document.getElementById('product-details');
            const detailsContent = document.getElementById('details-content');
            const pagination = document.querySelector('.pagination');

            detailsContent.innerHTML = `
                <h3>${product.title}</h3>
                <img src="${product.picture}" alt="${product.title}" style="margin: auto; width: 60%;  height: auto; margin-bottom: 20px; display: block; ">
                <h5 class="mb-5"><strong>Author:</strong> ${product.author}</h5>
                <p>${product.content}</p>
            `;

                // Section to block or hide some function
            document.getElementById('jewelery').style.display = 'none';
            document.getElementById('trend').style.display = 'none';
            // document.getElementById('tre').style.display = 'none';
            productDetailsContainer.style.display = 'block';
            pagination.classList.add('hidden'); 
            
                        // Scroll up to the product details container
            productDetailsContainer.scrollIntoView({ behavior: 'smooth'});
        }

        // Section for Back button 
        document.getElementById('back-button').addEventListener('click', () => {
            document.getElementById('product-details').style.display = 'none';
            document.getElementById('jewelery').style.display = 'flex';
            document.querySelector('.pagination').classList.remove('hidden');
        });

        function updatePaginationInfo() {
            const pageInfo = document.getElementById('pageInfo');
            const totalPages = Math.ceil(allProducts.length / productsPerPage);
            pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;

            document.getElementById('prevPage').disabled = currentPage === 1;
            document.getElementById('nextPage').disabled = currentPage === totalPages;
        }

        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                displayProducts();
                displayTrendingProducts();
            }
        }


        function nextPage() {
            const totalPages = Math.ceil(allProducts.length / productsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                displayProducts();
                displayTrendingProducts();
            }
        }
// ...............................................end.................................


function shareToSocialMedia(platform) {
  const url = window.location.href;
  const title = document.title;
  let shareUrl = '';

  switch(platform) {
      case 'facebook':
          shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&t=${encodeURIComponent(title)}`;
          break;
      case 'twitter':
          shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`;
          break;
      case 'whatsapp':
          shareUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(title + " " + url)}`;
          break;
      case 'email':
          shareUrl = `mailto:?subject=${encodeURIComponent(title)}&body=${encodeURIComponent(url)}`;
          break;
      case 'sms':
          shareUrl = `sms:?body=${encodeURIComponent(title + " " + url)}`;
          break;
      case 'instagram':
          shareUrl = `https://www.instagram.com/`;
          break;
      case 'tiktok':
          shareUrl = `https://www.tiktok.com/`;
          break;
      case 'messenger':
          shareUrl = `fb-messenger://share?link=${encodeURIComponent(url)}&app_id=YOUR_APP_ID`; // replace YOUR_APP_ID with your Facebook app ID
          break;
      case 'telegram':
          shareUrl = `https://api.telegram.com/send?text=${encodeURIComponent(title + " " + url)}`;
          break;
          case 'copylink':
      case 'copy':
          if (navigator.clipboard) {
              navigator.clipboard.writeText(url).then(() => {
                  alert('Link copied to clipboard!');
              }).catch(err => {
                  console.error('Failed to copy link: ', err);
              });
          } else {
              fallbackCopyTextToClipboard(url);
          }
          return;
      case 'native':
          if (navigator.share) {
              navigator.share({
                  title: title,
                  text: title,
                  url: url
              }).then(() => {
                  console.log('Successfully shared');
              }).catch((error) => {
                  console.error('Error sharing', error);
              });
          } else {
              alert('Web Share API is not supported in your browser.');
          }
          return;
      case 'chrome':
      case 'firefox':
      case 'edge':
      case 'safari':
          alert(`To share this link on ${platform.charAt(0).toUpperCase() + platform.slice(1)}, please use your browser's sharing options.`);
          return;
      default:
          console.log('Unknown platform');
          return;
  }

  if (shareUrl) {
      window.open(shareUrl, '_blank', 'width=600,height=400');
  }
}

function fallbackCopyTextToClipboard(text) {
  const textArea = document.createElement("textarea");
  textArea.value = text;
  textArea.style.position = "fixed";  // Prevent scrolling to bottom of page in MS Edge.
  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();

  try {
      document.execCommand('copy');
      alert('Link copied to clipboard!');
  } catch (err) {
      console.error('Fallback: Oops, unable to copy', err);
  }

  document.body.removeChild(textArea);
}


        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";  // Prevent scrolling to bottom of page in MS Edge.
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                document.execCommand('copy');
                alert('Link copied to clipboard!');
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
            }

            document.body.removeChild(textArea);
        }



        function scrollLeft() {
            const container = document.getElementById('share-buttons-container');
            container.scrollBy({
                left: -100,
                behavior: 'smooth'
            });
        }

        function scrollRight() {
            const container = document.getElementById('share-buttons-container');
            container.scrollBy({
                left: 100,
                behavior: 'smooth'
            });
        }




        
                    // section for zoom....................................................................
                    function toggleZoom(element) {
                element.classList.toggle('zoom');
            }
            // Sticky back-button-container
            window.onscroll = function () {
                const navbar = document.querySelector('.navbar');
                const navbarMenuContainer = document.getElementById('back-button');
                const navbarRect = navbar.getBoundingClientRect();
                const navbarMenuRect = navbarMenuContainer.getBoundingClientRect();

                if (window.scrollY >= navbarMenuRect.top) {
                    navbarMenuContainer.style.position = 'fixed';
                    navbarMenuContainer.style.top = `${navbarRect.height}px`;
                    // navbarMenuContainer.style.width = '10%';
                    navbarMenuContainer.style.zIndex = '999';
                } else {
                    navbarMenuContainer.style.position = 'static';
                    navbarMenuContainer.style.width = 'auto';
                }
            }


        window.onload = fetchData;
    </script>

</body>

</html> 

